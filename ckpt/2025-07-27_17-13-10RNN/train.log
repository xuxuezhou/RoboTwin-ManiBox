/home/xuxuezhou/miniconda3/envs/RoboTwin/lib/python3.10/site-packages/ultralytics/nn/tasks.py:775: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  ckpt = torch.load(file, map_location="cpu")
/home/xuxuezhou/code/RoboTwin/policy/ManiBox/manibox/ManiBox/dataloader/data_load.py:21: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  data = torch.load(os.path.join(dataset_dir, "integration.pkl"), map_location='cpu')
/home/xuxuezhou/code/RoboTwin/policy/ManiBox/manibox/ManiBox/dataloader/BBoxHistoryEpisodicDataset.py:52: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  self.data = torch.load(os.path.join(self.dataset_dir, "integration.pkl"), map_location='cpu')
Timestamp: 2025-07-27_17-13-10
scheduler: cos args.gradient_accumulation_steps 1
whether use acclerator: False
cur_path /home/xuxuezhou/code/RoboTwin/policy/ManiBox/manibox/ManiBox
num episodes 50

Data from: policy/ManiBox/processed_data/manibox-beat_block_hammer

Load data from policy/ManiBox/processed_data/manibox-beat_block_hammer/integration.pkl Shape:  torch.Size([50, 108, 12])
image_data.shape, qpos_data.shape, action_data.shape:  torch.Size([90, 12]) torch.Size([90, 14]) torch.Size([90, 14])
Load data from policy/ManiBox/processed_data/manibox-beat_block_hammer/integration.pkl Shape:  torch.Size([50, 108, 12])
image_data.shape, qpos_data.shape, action_data.shape:  torch.Size([90, 12]) torch.Size([90, 14]) torch.Size([90, 14])
length of train dataloader 1
You are using RNNPolicy.
policy_config {'lr': 0.002, 'lr_backbone': 7e-05, 'epochs': 50, 'train_loader_len': 1, 'warmup_ratio': 0.1, 'use_scheduler': 'cos', 'backbone': 'resnet18', 'masks': False, 'weight_decay': 0.0001, 'dilation': False, 'position_embedding': 'sine', 'loss_function': 'l1', 'chunk_size': 1, 'camera_names': ['cam_high', 'cam_left_wrist', 'cam_right_wrist'], 'num_next_action': 0, 'use_depth_image': False, 'use_robot_base': False, 'hidden_dim': 512, 'device': 'cuda:0', 'state_dim': 14, 'action_dim': 14, 'rnn_layers': 3, 'rnn_hidden_dim': 512, 'actor_hidden_dim': 512, 'policy_class': 'RNN', 'gradient_accumulation_steps': 1}
backbone visual encoder. number of parameters: 0.00M
temporal model. number of parameters: 5.58M
  0%|          | 0/50 [00:00<?, ?it/s]
0it [00:00, ?it/s][A
                  [A
Epoch 0, lr: 0.0004
Train loss: 0.79553
loss: 0.796 
Saved plots to ./ckpt/2025-07-27_17-13-10RNN
  2%|▏         | 1/50 [00:00<00:47,  1.04it/s]Best ckpt saved, val loss 0.795869 @ epoch0
Val loss:   0.79587.   Best val loss: 0.79587 at epoch 0
loss: 0.796 

Epoch 1, lr: 0.0008
Train loss: 0.79550
loss: 0.796 
Saved plots to ./ckpt/2025-07-27_17-13-10RNN
  4%|▍         | 2/50 [00:01<00:37,  1.27it/s]Best ckpt saved, val loss 0.784401 @ epoch1
Val loss:   0.78440.   Best val loss: 0.78440 at epoch 1
loss: 0.784 

Epoch 2, lr: 0.0012
Train loss: 0.78207
loss: 0.782 
Saved plots to ./ckpt/2025-07-27_17-13-10RNN
  6%|▌         | 3/50 [00:02<00:33,  1.39it/s]Best ckpt saved, val loss 0.774484 @ epoch2
Val loss:   0.77448.   Best val loss: 0.77448 at epoch 2
loss: 0.774 

Epoch 3, lr: 0.0016
Train loss: 0.77079
loss: 0.771 
Saved plots to ./ckpt/2025-07-27_17-13-10RNN
  8%|▊         | 4/50 [00:02<00:31,  1.44it/s]Best ckpt saved, val loss 0.753077 @ epoch3
Val loss:   0.75308.   Best val loss: 0.75308 at epoch 3
loss: 0.753 

Epoch 4, lr: 0.002
Train loss: 0.74440
loss: 0.744 
Saved plots to ./ckpt/2025-07-27_17-13-10RNN
 10%|█         | 5/50 [00:03<00:30,  1.46it/s]Best ckpt saved, val loss 0.608241 @ epoch4
Val loss:   0.60824.   Best val loss: 0.60824 at epoch 4
loss: 0.608 

Epoch 5, lr: 0.0019975640502598244
Train loss: 0.57297
loss: 0.573 
Saved plots to ./ckpt/2025-07-27_17-13-10RNN
 12%|█▏        | 6/50 [00:04<00:29,  1.50it/s]Val loss:   0.99539.   Best val loss: 0.60824 at epoch 4
loss: 0.995 

Epoch 6, lr: 0.0019902680687415705
Train loss: 0.98698
loss: 0.987 
Saved plots to ./ckpt/2025-07-27_17-13-10RNN
 14%|█▍        | 7/50 [00:04<00:28,  1.53it/s]Val loss:   0.78561.   Best val loss: 0.60824 at epoch 4
loss: 0.786 

Epoch 7, lr: 0.0019781476007338056
Train loss: 0.82402
loss: 0.824 
Saved plots to ./ckpt/2025-07-27_17-13-10RNN
 16%|█▌        | 8/50 [00:05<00:28,  1.50it/s]Best ckpt saved, val loss 0.499734 @ epoch7
Val loss:   0.49973.   Best val loss: 0.49973 at epoch 7
loss: 0.500 

Epoch 8, lr: 0.001961261695938319
Train loss: 0.48660
loss: 0.487 
Saved plots to ./ckpt/2025-07-27_17-13-10RNN
 18%|█▊        | 9/50 [00:06<00:29,  1.41it/s]Best ckpt saved, val loss 0.487099 @ epoch8
Val loss:   0.48710.   Best val loss: 0.48710 at epoch 8
loss: 0.487 

Epoch 9, lr: 0.0019396926207859084
Train loss: 0.43662
loss: 0.437 
Saved plots to ./ckpt/2025-07-27_17-13-10RNN
 20%|██        | 10/50 [00:07<00:28,  1.41it/s]Best ckpt saved, val loss 0.431835 @ epoch9
Val loss:   0.43184.   Best val loss: 0.43184 at epoch 9
loss: 0.432 

Epoch 10, lr: 0.001913545457642601
Train loss: 0.40669
loss: 0.407 
Saved plots to ./ckpt/2025-07-27_17-13-10RNN
 22%|██▏       | 11/50 [00:07<00:27,  1.40it/s]Best ckpt saved, val loss 0.307029 @ epoch10
Val loss:   0.30703.   Best val loss: 0.30703 at epoch 10
loss: 0.307 

Epoch 11, lr: 0.001882947592858927
Train loss: 0.30343
loss: 0.303 
Saved plots to ./ckpt/2025-07-27_17-13-10RNN
 24%|██▍       | 12/50 [00:08<00:27,  1.40it/s]Val loss:   0.32664.   Best val loss: 0.30703 at epoch 10
loss: 0.327 

Epoch 12, lr: 0.0018480480961564258
Train loss: 0.31974
loss: 0.320 
Saved plots to ./ckpt/2025-07-27_17-13-10RNN
 26%|██▌       | 13/50 [00:09<00:26,  1.38it/s]Best ckpt saved, val loss 0.262643 @ epoch12
Val loss:   0.26264.   Best val loss: 0.26264 at epoch 12
loss: 0.263 

Epoch 13, lr: 0.0018090169943749475
Train loss: 0.27626
loss: 0.276 
Saved plots to ./ckpt/2025-07-27_17-13-10RNN
 28%|██▊       | 14/50 [00:10<00:26,  1.35it/s]Best ckpt saved, val loss 0.245175 @ epoch13
Val loss:   0.24517.   Best val loss: 0.24517 at epoch 13
loss: 0.245 

Epoch 14, lr: 0.001766044443118978
Train loss: 0.24650
loss: 0.247 
Saved plots to ./ckpt/2025-07-27_17-13-10RNN
 30%|███       | 15/50 [00:10<00:25,  1.36it/s]Best ckpt saved, val loss 0.241495 @ epoch14
Val loss:   0.24150.   Best val loss: 0.24150 at epoch 14
loss: 0.241 

Epoch 15, lr: 0.001719339800338651
Train loss: 0.23901
loss: 0.239 
Saved plots to ./ckpt/2025-07-27_17-13-10RNN
 32%|███▏      | 16/50 [00:11<00:25,  1.33it/s]Best ckpt saved, val loss 0.208765 @ epoch15
Val loss:   0.20876.   Best val loss: 0.20876 at epoch 15
loss: 0.209 

Epoch 16, lr: 0.0016691306063588583
Train loss: 0.21629
loss: 0.216 
Saved plots to ./ckpt/2025-07-27_17-13-10RNN
 34%|███▍      | 17/50 [00:12<00:25,  1.28it/s]Best ckpt saved, val loss 0.184902 @ epoch16
Val loss:   0.18490.   Best val loss: 0.18490 at epoch 16
loss: 0.185 

Epoch 17, lr: 0.0016156614753256582
Train loss: 0.19229
loss: 0.192 
Saved plots to ./ckpt/2025-07-27_17-13-10RNN
 36%|███▌      | 18/50 [00:13<00:25,  1.25it/s]Best ckpt saved, val loss 0.179722 @ epoch17
Val loss:   0.17972.   Best val loss: 0.17972 at epoch 17
loss: 0.180 

Epoch 18, lr: 0.0015591929034707468
Train loss: 0.18509
loss: 0.185 
Saved plots to ./ckpt/2025-07-27_17-13-10RNN
 38%|███▊      | 19/50 [00:14<00:25,  1.24it/s]Best ckpt saved, val loss 0.170457 @ epoch18
Val loss:   0.17046.   Best val loss: 0.17046 at epoch 18
loss: 0.170 

Epoch 19, lr: 0.0015
Train loss: 0.18197
loss: 0.182 
Saved plots to ./ckpt/2025-07-27_17-13-10RNN
 40%|████      | 20/50 [00:14<00:24,  1.24it/s]Best ckpt saved, val loss 0.166035 @ epoch19
Val loss:   0.16603.   Best val loss: 0.16603 at epoch 19
loss: 0.166 
/home/xuxuezhou/code/RoboTwin/policy/ManiBox/manibox/ManiBox/train.py:141: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`). Consider using `matplotlib.pyplot.close()`.
  plt.figure()

Epoch 20, lr: 0.0014383711467890773
Train loss: 0.17531
loss: 0.175 
Saved plots to ./ckpt/2025-07-27_17-13-10RNN
 42%|████▏     | 21/50 [00:15<00:23,  1.22it/s]Best ckpt saved, val loss 0.153689 @ epoch20
Val loss:   0.15369.   Best val loss: 0.15369 at epoch 20
loss: 0.154 

Epoch 21, lr: 0.0013746065934159121
Train loss: 0.16707
loss: 0.167 
Saved plots to ./ckpt/2025-07-27_17-13-10RNN
 44%|████▍     | 22/50 [00:16<00:24,  1.14it/s]Best ckpt saved, val loss 0.140962 @ epoch21
Val loss:   0.14096.   Best val loss: 0.14096 at epoch 21
loss: 0.141 

Epoch 22, lr: 0.0013090169943749475
Train loss: 0.15686
loss: 0.157 
Saved plots to ./ckpt/2025-07-27_17-13-10RNN
 46%|████▌     | 23/50 [00:17<00:24,  1.10it/s]Best ckpt saved, val loss 0.127847 @ epoch22
Val loss:   0.12785.   Best val loss: 0.12785 at epoch 22
loss: 0.128 

Epoch 23, lr: 0.0012419218955996676
Train loss: 0.14648
loss: 0.146 
Saved plots to ./ckpt/2025-07-27_17-13-10RNN
 48%|████▊     | 24/50 [00:18<00:23,  1.12it/s]Best ckpt saved, val loss 0.125978 @ epoch23
Val loss:   0.12598.   Best val loss: 0.12598 at epoch 23
loss: 0.126 

Epoch 24, lr: 0.0011736481776669307
Train loss: 0.14257
loss: 0.143 
Saved plots to ./ckpt/2025-07-27_17-13-10RNN
 50%|█████     | 25/50 [00:19<00:21,  1.15it/s]Best ckpt saved, val loss 0.123077 @ epoch24
Val loss:   0.12308.   Best val loss: 0.12308 at epoch 24
loss: 0.123 

Epoch 25, lr: 0.0011045284632676536
Train loss: 0.13844
loss: 0.138 
Saved plots to ./ckpt/2025-07-27_17-13-10RNN
 52%|█████▏    | 26/50 [00:20<00:20,  1.19it/s]Best ckpt saved, val loss 0.118167 @ epoch25
Val loss:   0.11817.   Best val loss: 0.11817 at epoch 25
loss: 0.118 

Epoch 26, lr: 0.0010348994967025011
Train loss: 0.13307
loss: 0.133 
Saved plots to ./ckpt/2025-07-27_17-13-10RNN
 54%|█████▍    | 27/50 [00:21<00:19,  1.17it/s]Best ckpt saved, val loss 0.112227 @ epoch26
Val loss:   0.11223.   Best val loss: 0.11223 at epoch 26
loss: 0.112 

Epoch 27, lr: 0.0009651005032974994
Train loss: 0.12986
loss: 0.130 
Saved plots to ./ckpt/2025-07-27_17-13-10RNN
 56%|█████▌    | 28/50 [00:22<00:19,  1.10it/s]Best ckpt saved, val loss 0.105972 @ epoch27
Val loss:   0.10597.   Best val loss: 0.10597 at epoch 27
loss: 0.106 

Epoch 28, lr: 0.0008954715367323467
Train loss: 0.12590
loss: 0.126 
Saved plots to ./ckpt/2025-07-27_17-13-10RNN
 58%|█████▊    | 29/50 [00:23<00:19,  1.07it/s]Best ckpt saved, val loss 0.101759 @ epoch28
Val loss:   0.10176.   Best val loss: 0.10176 at epoch 28
loss: 0.102 

Epoch 29, lr: 0.0008263518223330697
Train loss: 0.12433
loss: 0.124 
Saved plots to ./ckpt/2025-07-27_17-13-10RNN
 60%|██████    | 30/50 [00:24<00:19,  1.03it/s]Val loss:   0.10222.   Best val loss: 0.10176 at epoch 28
loss: 0.102 

Epoch 30, lr: 0.0007580781044003324
Train loss: 0.12135
loss: 0.121 
Saved plots to ./ckpt/2025-07-27_17-13-10RNN
 62%|██████▏   | 31/50 [00:24<00:17,  1.10it/s]Best ckpt saved, val loss 0.099127 @ epoch30
Val loss:   0.09913.   Best val loss: 0.09913 at epoch 30
loss: 0.099 

Epoch 31, lr: 0.0006909830056250527
Train loss: 0.11876
loss: 0.119 
Saved plots to ./ckpt/2025-07-27_17-13-10RNN
 64%|██████▍   | 32/50 [00:25<00:15,  1.13it/s]Best ckpt saved, val loss 0.096910 @ epoch31
Val loss:   0.09691.   Best val loss: 0.09691 at epoch 31
loss: 0.097 

Epoch 32, lr: 0.0006253934065840879
Train loss: 0.11676
loss: 0.117 
Saved plots to ./ckpt/2025-07-27_17-13-10RNN
 66%|██████▌   | 33/50 [00:26<00:15,  1.10it/s]Best ckpt saved, val loss 0.094256 @ epoch32
Val loss:   0.09426.   Best val loss: 0.09426 at epoch 32
loss: 0.094 

Epoch 33, lr: 0.0005616288532109225
Train loss: 0.11448
loss: 0.114 
Saved plots to ./ckpt/2025-07-27_17-13-10RNN
 68%|██████▊   | 34/50 [00:27<00:15,  1.05it/s]Best ckpt saved, val loss 0.091271 @ epoch33
Val loss:   0.09127.   Best val loss: 0.09127 at epoch 33
loss: 0.091 

Epoch 34, lr: 0.0005000000000000002
Train loss: 0.11310
loss: 0.113 
Saved plots to ./ckpt/2025-07-27_17-13-10RNN
 70%|███████   | 35/50 [00:28<00:14,  1.07it/s]Best ckpt saved, val loss 0.089184 @ epoch34
Val loss:   0.08918.   Best val loss: 0.08918 at epoch 34
loss: 0.089 

Epoch 35, lr: 0.0004408070965292533
Train loss: 0.11139
loss: 0.111 
Saved plots to ./ckpt/2025-07-27_17-13-10RNN
 72%|███████▏  | 36/50 [00:29<00:13,  1.07it/s]Best ckpt saved, val loss 0.088118 @ epoch35
Val loss:   0.08812.   Best val loss: 0.08812 at epoch 35
loss: 0.088 

Epoch 36, lr: 0.0003843385246743417
Train loss: 0.11066
loss: 0.111 
Saved plots to ./ckpt/2025-07-27_17-13-10RNN
 74%|███████▍  | 37/50 [00:30<00:11,  1.11it/s]Best ckpt saved, val loss 0.087353 @ epoch36
Val loss:   0.08735.   Best val loss: 0.08735 at epoch 36
loss: 0.087 

Epoch 37, lr: 0.0003308693936411421
Train loss: 0.11025
loss: 0.110 
Saved plots to ./ckpt/2025-07-27_17-13-10RNN
 76%|███████▌  | 38/50 [00:31<00:11,  1.07it/s]Best ckpt saved, val loss 0.086336 @ epoch37
Val loss:   0.08634.   Best val loss: 0.08634 at epoch 37
loss: 0.086 

Epoch 38, lr: 0.00028066019966134904
Train loss: 0.10908
loss: 0.109 
Saved plots to ./ckpt/2025-07-27_17-13-10RNN
 78%|███████▊  | 39/50 [00:32<00:10,  1.05it/s]Best ckpt saved, val loss 0.085279 @ epoch38
Val loss:   0.08528.   Best val loss: 0.08528 at epoch 38
loss: 0.085 

Epoch 39, lr: 0.0002339555568810221
Train loss: 0.10818
loss: 0.108 
Saved plots to ./ckpt/2025-07-27_17-13-10RNN
 80%|████████  | 40/50 [00:33<00:09,  1.05it/s]Best ckpt saved, val loss 0.084421 @ epoch39
Val loss:   0.08442.   Best val loss: 0.08442 at epoch 39
loss: 0.084 

Epoch 40, lr: 0.00019098300562505265
Train loss: 0.10780
loss: 0.108 
Saved plots to ./ckpt/2025-07-27_17-13-10RNN
 82%|████████▏ | 41/50 [00:34<00:08,  1.04it/s]Best ckpt saved, val loss 0.083277 @ epoch40
Val loss:   0.08328.   Best val loss: 0.08328 at epoch 40
loss: 0.083 

Epoch 41, lr: 0.00015195190384357404
Train loss: 0.10654
loss: 0.107 
Saved plots to ./ckpt/2025-07-27_17-13-10RNN
 84%|████████▍ | 42/50 [00:35<00:07,  1.05it/s]Best ckpt saved, val loss 0.082228 @ epoch41
Val loss:   0.08223.   Best val loss: 0.08223 at epoch 41
loss: 0.082 

Epoch 42, lr: 0.00011705240714107302
Train loss: 0.10640
loss: 0.106 
Saved plots to ./ckpt/2025-07-27_17-13-10RNN
 86%|████████▌ | 43/50 [00:36<00:06,  1.07it/s]Best ckpt saved, val loss 0.081335 @ epoch42
Val loss:   0.08134.   Best val loss: 0.08134 at epoch 42
loss: 0.081 

Epoch 43, lr: 8.645454235739902e-05
Train loss: 0.10586
loss: 0.106 
Saved plots to ./ckpt/2025-07-27_17-13-10RNN
 88%|████████▊ | 44/50 [00:37<00:05,  1.08it/s]Best ckpt saved, val loss 0.080538 @ epoch43
Val loss:   0.08054.   Best val loss: 0.08054 at epoch 43
loss: 0.081 

Epoch 44, lr: 6.0307379214091684e-05
Train loss: 0.10561
loss: 0.106 
Saved plots to ./ckpt/2025-07-27_17-13-10RNN
 90%|█████████ | 45/50 [00:37<00:04,  1.08it/s]Best ckpt saved, val loss 0.079878 @ epoch44
Val loss:   0.07988.   Best val loss: 0.07988 at epoch 44
loss: 0.080 

Epoch 45, lr: 3.873830406168111e-05
Train loss: 0.10570
loss: 0.106 
Saved plots to ./ckpt/2025-07-27_17-13-10RNN
 92%|█████████▏| 46/50 [00:39<00:03,  1.05it/s]Best ckpt saved, val loss 0.079374 @ epoch45
Val loss:   0.07937.   Best val loss: 0.07937 at epoch 45
loss: 0.079 

Epoch 46, lr: 2.1852399266194312e-05
Train loss: 0.10477
loss: 0.105 
Saved plots to ./ckpt/2025-07-27_17-13-10RNN
 94%|█████████▍| 47/50 [00:40<00:03,  1.02s/it]Best ckpt saved, val loss 0.079053 @ epoch46
Val loss:   0.07905.   Best val loss: 0.07905 at epoch 46
loss: 0.079 

Epoch 47, lr: 9.731931258429638e-06
Train loss: 0.10536
loss: 0.105 
Saved plots to ./ckpt/2025-07-27_17-13-10RNN
 96%|█████████▌| 48/50 [00:42<00:02,  1.35s/it]Best ckpt saved, val loss 0.078871 @ epoch47
Val loss:   0.07887.   Best val loss: 0.07887 at epoch 47
loss: 0.079 

Epoch 48, lr: 2.4359497401758024e-06
Train loss: 0.10489
loss: 0.105 
Saved plots to ./ckpt/2025-07-27_17-13-10RNN
 98%|█████████▊| 49/50 [00:43<00:01,  1.35s/it]Best ckpt saved, val loss 0.078789 @ epoch48
Val loss:   0.07879.   Best val loss: 0.07879 at epoch 48
loss: 0.079 

Epoch 49, lr: 0.0
Train loss: 0.10429
loss: 0.104 
Saved plots to ./ckpt/2025-07-27_17-13-10RNN
100%|██████████| 50/50 [00:45<00:00,  1.43s/it]100%|██████████| 50/50 [00:45<00:00,  1.10it/s]
